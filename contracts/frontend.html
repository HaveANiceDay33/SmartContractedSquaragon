<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="UTF-8" />

<title>Smart Contracted Squaragon</title>
<!-- for connecting to metamask -->
<script src="./web3.min.js"></script>

<!-- this defines the Contract ID and ABI 
<script src="./blockynft_data.js" type="text/javascript"></script>
-->

<script type="text/javascript">
  // load web3 when page starts (or fail)
  window.addEventListener('load', function () {
      if (typeof window.ethereum !== 'undefined') {
          console.log('window.ethereum detected!')
          window.web3 = new Web3(window.ethereum);
          window.ethereum
                .request({ method: 'eth_requestAccounts' })
                .then( (accounts) => {
                    console.log("Connected to account id " + accounts[0]);
                    window.Squaragon.address = accounts[0];
                });
      } else {
          console.log('No window.ethereum detected.  :(')
      }
  })

  // This is a global data structure that models tokens.
  // Try inspecting it in the web console!
  window.Squaragon = {
    "address": 0,
  };

  // This is a helper function that generates a promise-generating function.
  // It's used to convert from the async .call() web3 functions to promises.
  const promisify = (method) =>
    new Promise((resolve, reject) =>
      method.call({from:window.Squaragon.address}, (err, res) => {
        if(err) { reject(err);  }
        else    { resolve(res); }
      })
    );
    </script>

</body>
</html>